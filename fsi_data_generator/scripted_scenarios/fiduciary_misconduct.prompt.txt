Analyze all fiduciary relationships for potential fiduciary misconduct.

Technical requirements:
1. Handle transaction dates in these formats:
   - ISO format with microseconds (e.g., '2023-03-01T10:15:00.123456')
   - ISO format without microseconds (e.g., '2023-03-01T10:15:00')
   - Simple date format (e.g., '2023-03-01')
2. When comparing amounts:
   - Use absolute values to handle negative amounts
   - Allow for small differences (< $0.01) in amount matching
   - Handle both string and numeric amount formats
3. For credit/debit indicators:
   - Check for opposite indicators (CREDIT vs DEBIT)
   - Handle various formats (credit/debit, CR/DR, +/-)
4. Do not use DATEADD or DATEDIFF in generated SQL. Date math should be done in Python.
5. LOB accounts and enterprise accounts are related by the enterpriseAccountId.
   But transactions are identified by the LOB account id.
6. Do not use CTEs in SQL queries.
7. Do not use subqueries in SQL queries.

Analysis requirements:
1. Analyze relationship types to determine fiduciary relationship types. Make no assumptions
   about the names of relationship types.
2. Focus on consumer banking transactions.
3. Identify matching transaction patterns between fiduciary and principal accounts within 3 days, including:
   - Exact amount matches with opposite credit/debit indicators
   - Split transactions where multiple fiduciary transactions add up to a principal transaction
   - Focus on all transactions
4. Flag patterns where:
   - Money moves between fiduciary and principal accounts
   - Transactions occur in close temporal proximity
   - Transaction descriptions suggest potential concealment
5. Report for each fiduciary-principal pair:
   - Names of fiduciary and principal
   - Number and total amount of suspicious transactions
   - Date range of suspicious activity
   - Types of suspicious patterns found
6. Highlight cases where:
   - A fiduciary shows patterns across multiple principals
   - Patterns occur repeatedly over time
   - Large amounts are involved

Be thorough and systematic and carefully follow instructions.
Verify that you completed all of the required steps.

